function visiblePass(elem) {
    if($(elem).hasClass('visible')) {
        $(elem).removeClass('visible')
        let input = $(elem).siblings('input[type="text"]')
        $(input).attr('type','password');
    } else {
        $(elem).addClass('visible')
        let input = $(elem).siblings('input[type="password"]')
        $(input).attr('type','text');
    }
}
$(function() {

    function minusNum(elem) {

        let input = $(elem).siblings('.wrap_number_input').find('input')
        var oldValue = parseFloat(input.val());
        if (oldValue <= 1) {
            var newVal = oldValue;
        } else {
            var newVal = oldValue - 1;
        }
        input.val(newVal);
        input.trigger("change");
    }

    function plusNum(elem) {
        let input = $(elem).siblings('.wrap_number_input').find('input')
        var oldValue = parseFloat(input.val());

        var newVal = oldValue + 1;

        input.val(newVal);
        input.trigger("change");
    }

    $('.busket_open').click(function () {
        $('#exampleBusket').arcticmodal();
    })

    // $('#exampleBusket').arcticmodal();

    $(".contact-form__phone").mask("+38(099)-999-99-99");

    $('.mc_link').hover(function() {
        $('.menu_catalog').addClass('catalog_hover')
    }, function() {
        $('.menu_catalog').removeClass('catalog_hover')
    })

    $('[data-fancybox="modal"]').fancybox({});
    $('.slider_list').slick({
        dots: true,
        infinite: true,
        speed: 300,
        slidesToShow: 1,
        adaptiveHeight: true
    })

    $('.open_reg').click(function () {
        $('#exampleModal2').arcticmodal();
    })

    $('.lc_login').click(function () {
        $.arcticmodal("close");
        $('#exampleModal3').arcticmodal();
    })

    $('.lc_reg').click(function () {
        $.arcticmodal("close");
        $('#exampleModal2').arcticmodal();
    })

    $('.modal_window').click(function () {
        $('#exampleModal').arcticmodal();
    })

    $('.slider_product_for').slick({
        slidesToShow: 1,
        slidesToScroll: 1,
        arrows: false,
        fade: false,
        asNavFor: '.slider_product_nav'
    });
    $('.slider_product_nav').slick({
        slidesToShow: 5,
        slidesToScroll: 1,
        arrows: false,
        vertical: true,
        verticalSwiping: true,
        // adaptiveHeight: true,
        focusOnSelect: true,
        asNavFor: '.slider_product_for',
        responsive: [
            {
                breakpoint: 767,
                settings: {
                    slidesToShow: 4,
                    vertical: false,
                    verticalSwiping: false,
                    adaptiveHeight: false,
                }
            },
            {
                breakpoint: 650,
                settings: {
                    slidesToShow: 3,
                    vertical: false,
                    verticalSwiping: false,
                    adaptiveHeight: false,
                }
            }
        ]
    });

    $("[data-submit]").on("click", function (e) {
        e.preventDefault();
        $(this).parent("form").submit();
    });

    $.validator.addMethod(
        "regex",
        function (value, element, regexp) {
            var re = new RegExp(regexp);
            return this.optional(element) || re.test(value);
        },
        "Please check your input."
    );

    // Функция валидации и вывода сообщений

    function valEl(el) {
        el.validate({
            rules: {
                tel: {
                    required: true,
                },
                name: {
                    required: true,
                },
                surname: {
                    required: true,
                },
                email: {
                    required: true,
                    email: true,
                },
                password : {
                    minlength : 5
                },
                password_confirm : {
                    minlength : 5,
                    equalTo : "#password"
                },
                login: {
                    required: true,
                },
            },
            messages: {
                login: {
                    required: "Введите логин",
                },
                tel: {
                    required: "Введите телефон",
                },
                name: {
                    required: "Введите имя",
                },
                surname: {
                    required: "Введите фамилию",
                },
                email: {
                    required: "Введите email",
                    email: "Некоректный email",
                },
                password : {
                    minlength : 'Пароль меньше 5 символов'
                },
                password_confirm : {
                    minlength : 'Пароль меньше 5 символов',
                    equalTo : "пароли не совпадают"
                }
            },

            // Начинаем проверку id="" формы
            submitHandler: function (form) {
                $.arcticmodal('close');
                var $form = $(form);
                var $formId = $(form).attr("id");
                switch ($formId) {
                    case "popupResult":
                        $.arcticmodal("close");
                        $.ajax({
                            type: "POST",
                            url: $form.attr("action"),
                            data: $form.serialize(),
                        })
                        break;
                    case "popupResult3":
                        $.ajax({
                            type: "POST",
                            url: $form.attr("action"),
                            data: $form.serialize(),
                        })
                        break;
                }
                return false;
            },
        });
    }

    // Запускаем механизм валидации форм, если у них есть класс .js-form

    $(".js-form").each(function () {
        valEl($(this));
    });

})
